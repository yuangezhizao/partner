<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <meta name = "format-detection" content="telephone=no">
    <meta name="description" content="口袋高校，大学生内容创业服务平台专注打造高校新媒体矩阵，最具性价比的校园营销渠道">
    <meta name="description" content="口袋高校，隶属于苏州扶摇信息科技有限公司，是国内领先新媒体运营机构，专注于全国高校新媒体运营和发展。公司旗下拥有近百个矩阵式高校新媒体账号，高校数量及用户数量每天都在稳步上增。口袋高校旗下有“口袋”“微在”及“圈圈”三大校园微信品牌，得天独厚的的高校新媒体资源是开展各项业务的保证，我们希望并将带领全国众多大学生新媒体运营者一起迈向“低成本小型创业”之路。">
    <meta name="keyword" content="口袋, 口袋高校, 内容创业服务平台">
    <title>卖室友</title>
    <script type="text/javascript" src="http://tajs.qq.com/stats?sId=59591163" charset="UTF-8"></script>
    <script type="text/javascript">
    // 对浏览器的UserAgent进行正则匹配，不含有微信独有标识的则为其他浏览器
    var useragent = navigator.userAgent;
    if (useragent.match(/MicroMessenger/i) != 'MicroMessenger') {
        // 这里警告框会阻塞当前页面继续加载
        alert('已禁止本次访问：您必须使用微信内置浏览器访问本页面！');
        // 以下代码是用javascript强行关闭当前页面
        var opened = window.open('about:blank', '_self');
        opened.opener = null;
        opened.close();
    }
</script>
    <link rel="stylesheet" href="https://res.wx.qq.com/open/libs/weui/1.0.1/weui.min.css">
    <link rel="stylesheet" href="http://static.pocketuniversity.cn/kdgx/RoommateShare/publish/css/look.css">
    <style>
      .header {
        width: 100%;
        overflow: hidden;
      }
      .show-all {
        width: 100%;
        height: 25px;
        line-height: 25px;
        background-color: white;
        text-align: center;
        font-size: 0.12rem;
        display: none;
      }
      #times {
          float: right;
          font-size: 13px;
      }
      .man-color #times {
          color: rgb(237,129,130);
      }
      .girl-color #times {
          color: rgb(89,172,133);
      }
    </style>
  </head>
  <body>
    <div class="page <?php if($data['sex']==0){echo 'man-color';?>
                <?php }else{ echo 'girl-color';?>
                <?php }?>
                ">
        <!-- header  -->
        <div class="header">
          <img id="photo_src" src="{$data['photo_src']}" alt="" />
          <div class="head-mask">

          </div>
        </div>
        <!-- header end -->
        <div class="show-all">点击查看完整靓照</div>
        <!-- infomation -->
        <div class="info-box">
            <div class="weui-cells__title">个人信息<span id="times">当前被要联系方式:{$data['times']}次</span></div>
            <div class="weui-cells">
                <a class="weui-cell" href="javascript:;">
                    <div class="weui-cell__bd">
                        <p>学校</p>
                    </div>
                    <div id="school" class="weui-cell__ft">{$data['school']}</div>
                </a>
                <if condition="$data['grade'] eq ''">
                <a class="weui-cell" href="javascript:;">
                    <div class="weui-cell__bd">
                        <p>身高</p>
                    </div>
                    <div id="school" class="weui-cell__ft">{$data['height']}CM</div>
                </a>
                <a class="weui-cell" href="javascript:;">
                    <div class="weui-cell__bd">
                        <p>年龄</p>
                    </div>
                    <div id="school" class="weui-cell__ft">
                    <if condition="$data['age'] eq ''">
                    保密
                    <else/>
                    {$data['age']}
                    </if>
                    </div>
                </a>
                </if>
                <a class="weui-cell" href="javascript:;">
                    <div class="weui-cell__bd">
                        <p>专业&年级</p>
                    </div>
                    <if condition="$data['grade'] eq ''">
                    <div id="subject" class="weui-cell__ft">{$data['subject']}</div>
                    <else/>
                    <div id="subject" class="weui-cell__ft">{$data['subject']} {$data['grade']}</div>
                    </if>
                </a>
                <!-- <a class="weui-cell" href="javascript:;">
                    <div class="weui-cell__bd">
                        <p>年级</p>
                    </div>
                    <div id="grade" class="weui-cell__ft">{$data['grade']}</div>
                </a> -->
                <a class="weui-cell">
                    <div class="weui-cell__bd">
                        <p>故乡</p>
                    </div>
                    <div id="name" class="weui-cell__ft">{$data['name']}</div>
                </a>
                <!-- 星座 -->
                <a class="weui-cell">
                    <div class="weui-cell__bd">
                        <p>星座</p>
                    </div>
                    <div id="star" class="weui-cell__ft">{$data['star']}</div>
                </a>
                <!-- 星座 -->
                <!-- 联系方式 -->
                <a class="weui-cell">
                    <div id="contype" class="weui-cell__bd">
                        <p>{$data['contype']}</p>
                    </div>
                    <div id="contact" class="weui-cell__ft">{$data['contact']}</div>
                </a>
                <!-- 联系方式 -->
            </div>
        </div>
        <!-- infomation -->

        <!-- self des -->
        <div class="self-box">
            <div class="weui-cells__title">自我描述</div>
            <div class="textarea-cell weui-cells weui-cells_form">
                <div class="weui-cell">
                    <div class="weui-cell__bd">
                        <p id="introduce" style="min-height:25px" class="weui-textarea">
                        {$data['introduce']}
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- self des -->

        <!-- wish -->
        <div class="self-box">
            <div class="weui-cells__title">对另一半的期望</div>
            <div class="textarea-cell weui-cells weui-cells_form">
                <div class="weui-cell">
                    <div class="weui-cell__bd">
                        <p id="expect" style="min-height:25px" class="weui-textarea">
                        {$data['expect']}
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- wish -->

        <!-- bottom btn -->
        <div class="opear-btn-box">
          <a href="/index.php/home/user/login?from=%2Findex.php%2Fpartner%2Fpartner%2Fhistory" id="share" class="confirm-btn btn weui-btn">查看我的“买卖”历史</a>
        </div>
        <!-- bottom btn -->
    </div>
  </body>
  <script>
  // alert(navigator.userAgent)
  	// rem adjust
    var bodyWidth = document.querySelector('body').offsetWidth
    var bodyHeight = document.querySelector('body').offsetHeight
    var scaleRatio = bodyWidth/320
    document.querySelector('html').style.fontSize = 100 * scaleRatio + 'px'
  </script>
  <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
  <script>
    $('.header').style.maxHeight = $('.header').offsetWidth + 'px'
    window.onload = function() {
	    $('#photo_src').onload = function () {
	      if($('.header').offsetWidth < $('#photo_src').offsetHeight) {
	        $('.show-all').show()
	      }
	    }
    }


    // 图片展开
    var showAll = false
    $('.show-all').onclick = function () {
      if(showAll) {
        showAll = !showAll
        $('.show-all').innerText = '点击查看完整靓照'
        $('.header').style.maxHeight = $('.header').offsetWidth + 'px'
      }else {
        showAll = !showAll
        $('.show-all').innerText = '点击收起靓照'
        $('.header').style.maxHeight = 'initial'
      }
    }

    if(parseQueryString(location.search).from == '1') {
        // console.log(parseQueryString(location.search).from)
        $('.opear-btn-box').hide()
    }

  	function $(selector) {
	    if(typeof selector !== 'string' && typeof selector !== 'object') {
	      console.error('arg need a selector or node object')
	      return
	    }

	    var node = typeof selector === 'string' ? document.querySelector(selector) : selector

	    // functions
	    node.show = function () {
	      this.style.display = 'block'
	      return this
	    }
	    node.hasShow = function () {
	      return this.style.display === 'block' ? true : false
	    }
	    node.hide = function () {
	      this.style.display = 'none'
	      return this
	    }

	    return node
  	}

    function parseQueryString(query) {
      let queryObj = {}
      let arr = query.substr(query.indexOf('?') + 1).split('&')
      arr.forEach(function(item) {
        let tmp = item.split('=')
        queryObj[tmp[0]] = tmp[1]
      })
      return queryObj
    }
  </script>
  <script>
    // jssdk
    var xhr = new XMLHttpRequest()
    xhr.onreadystatechange = function () {
      if(xhr.readyState != 4) {
        return
      }
      if(xhr.status != 200) {
        console.log('wx error')
        return
      }

      res = JSON.parse(xhr.responseText)
      wx.config({
          debug: false,
          appId: res.appId,
          timestamp: res.timestamp,
          nonceStr: res.nonceStr,
          signature: res.signature,
          jsApiList: [
            'hideOptionMenu'
          ]
      })
      // 一定在ready里调用，否则可能不生效
      wx.ready(function () {
      	console.log('success')
        wx.hideOptionMenu()
      })
      wx.error(function () {
        console.log('error')
      })

    }
    xhr.open("POST", "/wechatShare.php")
    xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded;")
    xhr.send("url=" + encodeURIComponent(location.href.split('#')[0]))
  </script>
</html>
